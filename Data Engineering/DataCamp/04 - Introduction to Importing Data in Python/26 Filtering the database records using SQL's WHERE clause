# Filtering the database records using SQL's WHERE clause

# Background:
# Let's say, for example that you wanted to get all records from the Customer table of the Chinook database for which the Country is 'Canada'. 
# You can do this very easily in SQL using a SELECT statement followed by a WHERE clause as follows:
	# SELECT * FROM Customer WHERE Country = 'Canada'
# In fact, you can filter any SELECT statement by any condition using a WHERE clause. This is called filtering your records.
# In this exercise, you'll select all records of the Employee table for which 'EmployeeId' is greater than or equal to 6.
# Packages are already imported as follows:
	# import pandas as pd
	# from sqlalchemy import create_engine	
	
	

# Excercises:
# Complete the argument of create_engine() so that the engine for the SQLite database 'Chinook.sqlite' is created.
# Execute the query that selects all records from the Employee table where 'EmployeeId' is greater than or equal to 6. Use the >= operator and assign the results to rs.
# Apply the method fetchall() to rs in order to fetch all records in rs. Store them in the DataFrame df.
# Using the rs object, set the DataFrame's column names to the corresponding names of the table columns.



# Create engine: engine
engine = create_engine('sqlite:///Chinook.sqlite')

# Open engine in context manager
# Perform query and save results to DataFrame: df
with engine.connect() as con:
    rs = con.execute("Select * FROM EMPLOYEE WHERE EmployeeId >=6")
    df = pd.DataFrame(rs.fetchmany(size=5))
    df.columns = rs.keys()

# Print the head of the DataFrame df
print(df.head())
